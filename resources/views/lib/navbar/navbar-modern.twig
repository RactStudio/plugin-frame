<!-- Main Navigation -->
<nav id="pf-main-nav" class="pf-bg-gray-100 pf-dark:pf-bg-gray-800 pf-rounded-md pf-hidden md:pf-block">
  <ul class="md:pf-flex md:pf-space-x-6 pf-flex-col md:pf-flex-row">
    <!-- Mega Menu Item -->
    <li class="pf-relative">
      <button id="pf-submenu-button" class="pf-flex pf-items-center pf-px-4 pf-py-2 pf-text-gray-800 pf-dark:pf-text-white">
        Dashboard
        <span id="pf-submenu-icon" class="dashicons pf-ml-1 dashicons-arrow-down-alt2"></span>
      </button>

      <!-- Mega Menu Dropdown -->
      <div id="pf-submenu" class="pf-absolute pf-left-0 pf-w-full md:pf-w-48 pf-bg-white pf-dark:pf-bg-gray-700 pf-rounded-md pf-shadow-lg pf-z-50 pf-hidden">
        <div class="pf-grid md:pf-grid-cols-2 lg:pf-grid-cols-3 pf-gap-4 pf-p-4">
          <!-- Mega Menu Content -->
          <div>
            <h3 class="pf-text-lg pf-font-semibold pf-mb-2">Category 1</h3>
            <a href="#" class="pf-block pf-py-2 pf-px-4 pf-text-gray-700 pf-dark:pf-text-gray-200 pf-hover:pf-bg-gray-100 pf-dark:pf-hover:pf-bg-gray-600">Subitem 1</a>
            <a href="#" class="pf-block pf-py-2 pf-px-4 pf-text-gray-700 pf-dark:pf-text-gray-200 pf-hover:pf-bg-gray-100 pf-dark:pf-hover:pf-bg-gray-600">Subitem 2</a>
          </div>
          <!-- Add more columns as needed -->
        </div>
      </div>
    </li>

    <!-- Regular Menu Items -->
    <li>
      <a href="#" class="pf-block pf-px-4 pf-py-2 pf-text-gray-800 pf-dark:pf-text-white pf-hover:pf-bg-gray-200 pf-dark:pf-hover:pf-bg-gray-600">Settings</a>
    </li>
    <li>
      <a href="#" class="pf-block pf-px-4 pf-py-2 pf-text-gray-800 pf-dark:pf-text-white pf-hover:pf-bg-gray-200 pf-dark:pf-hover:pf-bg-gray-600">Tools</a>
    </li>
  </ul>
</nav>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const mobileMenuButton = document.getElementById("pf-mobile-menu-button");
  const menuOpenIcon = document.getElementById("pf-menu-open-icon");
  const menuCloseIcon = document.getElementById("pf-menu-close-icon");
  const mainNav = document.getElementById("pf-main-nav");
  const submenuButton = document.getElementById("pf-submenu-button");
  const submenu = document.getElementById("pf-submenu");
  const submenuIcon = document.getElementById("pf-submenu-icon");

  // Track menu state
  let isMenuOpen = false;

  // Toggle mobile menu
  mobileMenuButton.addEventListener("click", function () {
    isMenuOpen = !isMenuOpen; // Toggle state
    mainNav.classList.toggle("pf-hidden", !isMenuOpen);
    menuOpenIcon.classList.toggle("pf-hidden", isMenuOpen);
    menuCloseIcon.classList.toggle("pf-hidden", !isMenuOpen);
  });

  // Toggle submenu on mobile
  submenuButton.addEventListener("click", function (e) {
    if (window.innerWidth < 768) {
      e.preventDefault();
      const isSubmenuOpen = submenu.classList.toggle("pf-hidden");
      submenuIcon.classList.toggle("dashicons-arrow-down-alt2", !isSubmenuOpen);
      submenuIcon.classList.toggle("dashicons-arrow-up-alt2", isSubmenuOpen);
    }
  });

  // Show submenu on hover (desktop)
  const submenuParent = submenuButton.parentElement;
  submenuParent.addEventListener("mouseenter", function () {
    if (window.innerWidth >= 768) {
      submenu.classList.remove("pf-hidden");
    }
  });

  submenuParent.addEventListener("mouseleave", function () {
    if (window.innerWidth >= 768) {
      submenu.classList.add("pf-hidden");
    }
  });

  // Close submenu when clicking outside
  document.addEventListener("click", function (e) {
    if (!submenu.contains(e.target) && !submenuButton.contains(e.target)) {
      submenu.classList.add("pf-hidden");
      submenuIcon.classList.remove("dashicons-arrow-up-alt2");
      submenuIcon.classList.add("dashicons-arrow-down-alt2");
    }
  });

  // Handle window resize
  window.addEventListener("resize", function () {
    if (window.innerWidth >= 768) {
      // Reset menu and submenu states on desktop
      mainNav.classList.remove("pf-hidden");
      submenu.classList.add("pf-hidden");
      submenuIcon.classList.remove("dashicons-arrow-up-alt2");
      submenuIcon.classList.add("dashicons-arrow-down-alt2");
      isMenuOpen = false; // Ensure menu state is reset
      menuOpenIcon.classList.remove("pf-hidden");
      menuCloseIcon.classList.add("pf-hidden");
    } else {
      // Ensure menu is hidden on mobile
      mainNav.classList.add("pf-hidden");
      menuOpenIcon.classList.remove("pf-hidden");
      menuCloseIcon.classList.add("pf-hidden");
    }
  });
});
</script>